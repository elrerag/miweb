


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-5.1.6">
    
    
      
        <title>Lectura002 001 - Java Full Stack Docs</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.4b9ffd7b.min.css">
      
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    <body dir="ltr">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#unidad-621-rest" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../../../.." title="Java Full Stack Docs" class="md-header-nav__button md-logo" aria-label="Java Full Stack Docs">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Java Full Stack Docs
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Lectura002 001
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Java Full Stack Docs" class="md-nav__button md-logo" aria-label="Java Full Stack Docs">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Java Full Stack Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../../../ejercicios/repaso/teoria/poo/herencia/" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#6211-principios-de-diseno-de-una-api-rest" class="md-nav__link">
    6.2.1.1 - Principios de diseño de una API REST
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6212-ejemplo-api-sin-seguridad" class="md-nav__link">
    6.2.1.2 - Ejemplo API - sin seguridad
  </a>
  
    <nav class="md-nav" aria-label="6.2.1.2 - Ejemplo API - sin seguridad">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#servicios" class="md-nav__link">
    Servicios
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#estructura" class="md-nav__link">
    Estructura
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cllherrerapr" class="md-nav__link">
    cl.lherrera.pr
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cllherreraprcontroller" class="md-nav__link">
    cl.lherrera.pr.controller
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cllherreraprdto" class="md-nav__link">
    cl.lherrera.pr.dto
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cllherreraprmodeloentity" class="md-nav__link">
    cl.lherrera.pr.modelo.entity
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cllherreraprmodelorepository" class="md-nav__link">
    cl.lherrera.pr.modelo.repository
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cllherreraprservicio" class="md-nav__link">
    cl.lherrera.pr.servicio
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cllherreraprutils" class="md-nav__link">
    cl.lherrera.pr.utils
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#produce-restsrcmainresources" class="md-nav__link">
    /produce-rest/src/main/resources
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#produce-restpomxml" class="md-nav__link">
    /produce-rest/pom.xml
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  
                
                
                <blockquote>
<h1 id="unidad-621-rest">Unidad 6.2.1 - Rest</h1>
<blockquote>
<p>Creación de un servicio probado con PostMan, el mismo de la lectura.</p>
</blockquote>
</blockquote>
<hr />
<h2 id="6211-principios-de-diseno-de-una-api-rest"><strong><em>6.2.1.1 - Principios de diseño de una API REST</em></strong></h2>
<p>No usar verbos en las <code>URIs</code>. Los propios verbos como <code>post, put, delete, get</code>, se encargan de realizar las tareas para lo que están diseñadas, desde una sola <code>URI</code>, no quitar el protagonismo a estos verbos, por ejemplo:</p>
<ul>
<li><code>/obtenerPersonas</code><ul>
<li><code>/personas (get)</code></li>
</ul>
</li>
<li><code>/crearPersona</code><ul>
<li><code>/personas (post)</code></li>
</ul>
</li>
<li><code>/actualizarPersona/2</code><ul>
<li><code>/personas/2 (put)</code></li>
</ul>
</li>
<li><code>/eliminarPersona/2</code><ul>
<li><code>/personas/2 (delete)</code></li>
</ul>
</li>
</ul>
<p>Usar sustantivos plurales para todas sus peticiones:</p>
<ul>
<li><code>/autos</code></li>
<li><code>/personas</code></li>
<li><code>/polizas</code></li>
</ul>
<p>Utilizar los métodos correctos para cumplir con el <code>Nivel 2</code> al menos.</p>
<ul>
<li><code>GET</code> : Se utiliza para <strong>obtener</strong> un recurso o una colección de recursos. </li>
<li><code>POST</code> : Se utiliza para <strong>crear</strong> un recurso o una colección de recursos. </li>
<li><code>PUT</code> : Se utiliza para <strong>actualizar</strong> un recurso o una colección de recursos. (Es como un post con un identificador por URL, perfecto para el update.)</li>
<li><code>DELETE</code> : Se utiliza para <strong>actualizar</strong> un recurso o una colección de recursos.</li>
</ul>
<p>Utilización de versionamiento en la <code>API</code>, ya que esta puede ser actualizada y hay clientes que consumen sin cambios la versión que existía, es por eso que lo mejor es indicar la versión en la propia <code>URI</code>.</p>
<ul>
<li><code>/api/v1/autos</code></li>
<li><code>/api/autos/?version=1</code></li>
<li><code>API-VERSION = 1</code> "En el <code>header</code>"</li>
</ul>
<p>Todas estas opciones deben ser controladas en la <code>API</code>.</p>
<p>Los códigos <a href="https://www.tutorialspoint.com/http/http_status_codes.htm"><code>HTTP - Status Codes</code></a> deben ser correctamente indicados para cumplir con el <code>Nivel 2</code>. Algunos de estos códigos son:</p>
<ul>
<li><code>200 – OK</code>: Todo ocurrió bien, respuesta exitosa.</li>
<li><code>201 – OK</code>: Nuevo recurso ha sido creado. </li>
<li><code>204 – OK</code>: Recurso eliminado. </li>
<li><code>400 – Bad Request</code>: Solicitud inválida. </li>
<li><code>401 – Unauthorized</code>: Requiere autorización. </li>
<li><code>403 – Forbidden</code>: Acceso prohibido. </li>
<li><code>404 – Not found</code>: No se ha encontrado el recurso. </li>
<li><code>422 – Unprocessable Entity</code>: No puede procesar una entidad. Por ejemplo cuando se envía un cuerpo erróneo en la petición.</li>
</ul>
<hr />
<h2 id="6212-ejemplo-api-sin-seguridad"><strong><em>6.2.1.2 - Ejemplo API - sin seguridad</em></strong></h2>
<h3 id="servicios"><strong>Servicios</strong></h3>
<p>Servicios a probar:</p>
<p>URL: <code>http://localhost:8080</code>.</p>
<p><strong>Ingresar Usuario</strong></p>
<p>Ingresa usuarios al sistema, no tendremos resultados, si no hemos ejecutado antes esta petición, no tendremos resultados en la consulta de los usuarios.</p>
<p>URI: <code>/api/v1/users</code></p>
<p>URL: <code>http://localhost:8080/api/v1/users</code></p>
<p><code>BODY</code>:</p>
<pre><code class="json">{ 
  &quot;name&quot;:&quot;Luis&quot;, 
  &quot;alias&quot;:&quot;lherrera&quot; 
} 
</code></pre>

<p><strong>Obtener Usuarios</strong></p>
<p>Obtiene la lista de usuarios en el sistema.</p>
<p>URI: <code>/api/v1/users</code></p>
<p>URL: <code>http://localhost:8080/api/v1/users</code></p>
<p>TIPO: <code>GET</code></p>
<p><code>HEADERS</code></p>
<p>Recordar que en <code>Postman</code>, si se elige el <code>body</code> raw, y <code>json</code> el <code>header</code> se llena solo.</p>
<pre><code class="json">{
  &quot;Content-Type&quot;: &quot;application/json&quot;
}
</code></pre>

<p>Luego para actualizar:</p>
<pre><code>&gt; PUT /api/v1/users HTTP/1.1 
&gt; Host: localhost:8080 
&gt; User-Agent: insomnia/6.5.4 
&gt; Content-Type: application/json &gt; Accept: */* 
&gt; Content-Length: 50 
</code></pre>

<pre><code class="json">{ 
  &quot;id&quot;: 1, 
  &quot;name&quot;:&quot;Luis&quot;, 
  &quot;alias&quot;:&quot;lh1234&quot; 
} 
</code></pre>

<p>Luego eliminar</p>
<pre><code>&gt; DELETE /api/v1/users HTTP/1.1 &gt; Host: localhost:8080 
&gt; User-Agent: insomnia/6.5.4 
&gt; Content-Type: application/json &gt; Accept: */* 
&gt; Content-Length: 11 
</code></pre>

<pre><code class="json">{ 
  &quot;id&quot;: 1
}
</code></pre>

<h3 id="estructura"><strong>Estructura</strong></h3>
<pre><code>./
├── HELP.md
├── mvnw
├── mvnw.cmd
├── pom.xml
├── produce-rest.db
├── src
│   ├── main
│   │   ├── java
│   │   │   └── cl
│   │   │       └── lherrera
│   │   │           └── pr
│   │   │               ├── AppConfig.java
│   │   │               ├── ProduceRestApplication.java
│   │   │               ├── SQLiteDialect.java
│   │   │               ├── ServletInitializer.java
│   │   │               ├── controller
│   │   │               │   └── UserController.java
│   │   │               ├── dto
│   │   │               │   └── UserDTO.java
│   │   │               ├── modelo
│   │   │               │   ├── entity
│   │   │               │   │   └── User.java
│   │   │               │   └── repository
│   │   │               │       └── UserRepository.java
│   │   │               ├── servicio
│   │   │               │   ├── UserService.java
│   │   │               │   └── UserServiceImp.java
│   │   │               └── utils
│   │   │                   └── DTOMapper.java
│   │   ├── resources
│   │   │   ├── application.properties
│   │   │   ├── database.properties
│   │   │   ├── static
│   │   │   └── templates
│   │   └── webapp
│   └── test
│       └── java
│           └── cl
│               └── lherrera
│                   └── pr
│                       └── ProduceRestApplicationTests.java
└── target
    ├── classes
    │   ├── application.properties
    │   ├── cl
    │   │   └── lherrera
    │   │       └── pr
    │   │           └── SQLiteDialect.class
    │   └── database.properties
    ├── m2e-wtp
    │   └── web-resources
    │       └── META-INF
    │           ├── MANIFEST.MF
    │           └── maven
    │               └── cl.lherrera
    │                   └── produce-rest
    │                       ├── pom.properties
    │                       └── pom.xml
    └── test-classes

34 directories, 25 files

</code></pre>

<h3 id="cllherrerapr"><strong><code>cl.lherrera.pr</code></strong></h3>
<p>Paquete principal. Contiene las clases de inicio de aplicación, además de configuración de la conexión a la base de datos y clases de configuración.</p>
<p>Estas clases, sobre todo las de configuración de la base de datos, se pueden replicar a otros proyectos, ya que no tienen grandes cambios. Ver el detalle en cada una</p>
<p><strong><code>/produce-rest/src/main/java/cl/lherrera/pr/AppConfig.java</code></strong></p>
<p>Configuración de conexión a la base de datos, utiliza su propio archivo de configuración.</p>
<pre><code class="java">package cl.lherrera.pr;

import javax.sql.DataSource;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.ComponentScan;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.PropertySource;
import org.springframework.core.env.Environment;
import org.springframework.jdbc.datasource.DriverManagerDataSource;

@Configuration
@ComponentScan(&quot;cl.lherrera.pr&quot;)
@PropertySource(&quot;classpath:database.properties&quot;)
public class AppConfig {

    @Autowired
    Environment environment;

    @Bean
    DataSource dataSource() {
        DriverManagerDataSource driverManagerDataSource = new DriverManagerDataSource();
        driverManagerDataSource.setUrl(environment.getProperty(&quot;url&quot;));
        driverManagerDataSource.setUsername(environment.getProperty(&quot;username&quot;));
        driverManagerDataSource.setPassword(environment.getProperty(&quot;dbpassword&quot;));
        driverManagerDataSource.setDriverClassName(environment.getProperty(&quot;driverClassName&quot;));
        return driverManagerDataSource;
    }

}
</code></pre>

<p><code>/produce-rest/src/main/java/cl/lherrera/pr/ProduceRestApplication.java</code></p>
<p>Sin cambios.</p>
<pre><code class="java">package cl.lherrera.pr;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class ProduceRestApplication {

    public static void main(String[] args) {
        SpringApplication.run(ProduceRestApplication.class, args);
    }

}

</code></pre>

<p><code>/produce-rest/src/main/java/cl/lherrera/pr/ServletInitializer.java</code></p>
<p>Sin cambios.</p>
<pre><code class="java">package cl.lherrera.pr;

import org.springframework.boot.builder.SpringApplicationBuilder;
import org.springframework.boot.web.servlet.support.SpringBootServletInitializer;

public class ServletInitializer extends SpringBootServletInitializer {

    @Override
    protected SpringApplicationBuilder configure(SpringApplicationBuilder application) {
        return application.sources(ProduceRestApplication.class);
    }

}

</code></pre>

<p><code>/produce-rest/src/main/java/cl/lherrera/pr/SQLiteDialect.java</code></p>
<p>Archivo necesario para poder utilizar <code>SQLITE</code>. Lo único que hay que adaptar en este archivo, es si es utilizado en otro proyecto, entonces se actualiza el nombre del paquete.</p>
<pre><code class="java">package cl.lherrera.pr;

import java.sql.Types;

import org.hibernate.dialect.Dialect;
import org.hibernate.dialect.function.StandardSQLFunction;
import org.hibernate.dialect.function.SQLFunctionTemplate;
import org.hibernate.dialect.function.VarArgsSQLFunction;
import org.hibernate.type.StandardBasicTypes;

public class SQLiteDialect extends Dialect {
    public SQLiteDialect() {
        super();
        registerColumnType(Types.BIT, &quot;integer&quot;);
        registerColumnType(Types.TINYINT, &quot;tinyint&quot;);
        registerColumnType(Types.SMALLINT, &quot;smallint&quot;);
        registerColumnType(Types.INTEGER, &quot;integer&quot;);
        registerColumnType(Types.BIGINT, &quot;bigint&quot;);
        registerColumnType(Types.FLOAT, &quot;float&quot;);
        registerColumnType(Types.REAL, &quot;real&quot;);
        registerColumnType(Types.DOUBLE, &quot;double&quot;);
        registerColumnType(Types.NUMERIC, &quot;numeric&quot;);
        registerColumnType(Types.DECIMAL, &quot;decimal&quot;);
        registerColumnType(Types.CHAR, &quot;char&quot;);
        registerColumnType(Types.VARCHAR, &quot;varchar&quot;);
        registerColumnType(Types.LONGVARCHAR, &quot;longvarchar&quot;);
        registerColumnType(Types.DATE, &quot;date&quot;);
        registerColumnType(Types.TIME, &quot;time&quot;);
        registerColumnType(Types.TIMESTAMP, &quot;timestamp&quot;);
        registerColumnType(Types.BINARY, &quot;blob&quot;);
        registerColumnType(Types.VARBINARY, &quot;blob&quot;);
        registerColumnType(Types.LONGVARBINARY, &quot;blob&quot;);
        // registerColumnType(Types.NULL, &quot;null&quot;);
        registerColumnType(Types.BLOB, &quot;blob&quot;);
        registerColumnType(Types.CLOB, &quot;clob&quot;);
        registerColumnType(Types.BOOLEAN, &quot;integer&quot;);

        registerFunction(&quot;concat&quot;, new VarArgsSQLFunction(StandardBasicTypes.STRING, &quot;&quot;, &quot;||&quot;, &quot;&quot;));
        registerFunction(&quot;mod&quot;, new SQLFunctionTemplate(StandardBasicTypes.INTEGER, &quot;?1 % ?2&quot;));
        registerFunction(&quot;substr&quot;, new StandardSQLFunction(&quot;substr&quot;, StandardBasicTypes.STRING));
        registerFunction(&quot;substring&quot;, new StandardSQLFunction(&quot;substr&quot;, StandardBasicTypes.STRING));
    }

    public boolean supportsIdentityColumns() {
        return true;
    }

    public boolean hasDataTypeInIdentityColumn() {
        return false; // As specify in NHibernate dialect
    }

    public String getIdentityColumnString() {
        // return &quot;integer primary key autoincrement&quot;;
        return &quot;integer&quot;;
    }

    public String getIdentitySelectString() {
        return &quot;select last_insert_rowid()&quot;;
    }

    public boolean supportsLimit() {
        return true;
    }

    public String getLimitString(String query, boolean hasOffset) {
        return new StringBuffer(query.length() + 20).append(query).append(hasOffset ? &quot; limit ? offset ?&quot; : &quot; limit ?&quot;)
                .toString();
    }

    public boolean bindLimitParametersInReverseOrder() {
        return true;
    }

    public boolean supportsTemporaryTables() {
        return true;
    }

    public String getCreateTemporaryTableString() {
        return &quot;create temporary table if not exists&quot;;
    }

    public boolean dropTemporaryTableAfterUse() {
        return false;
    }

    public boolean supportsCurrentTimestampSelection() {
        return true;
    }

    public boolean isCurrentTimestampSelectStringCallable() {
        return false;
    }

    public String getCurrentTimestampSelectString() {
        return &quot;select current_timestamp&quot;;
    }

    public boolean supportsUnionAll() {
        return true;
    }

    public boolean hasAlterTable() {
        return false; // As specify in NHibernate dialect
    }

    public boolean dropConstraints() {
        return false;
    }

    public String getAddColumnString() {
        return &quot;add column&quot;;
    }

    public String getForUpdateString() {
        return &quot;&quot;;
    }

    public boolean supportsOuterJoinForUpdate() {
        return false;
    }

    public String getDropForeignKeyString() {
        throw new UnsupportedOperationException(&quot;No drop foreign key syntax supported by SQLiteDialect&quot;);
    }

    public String getAddForeignKeyConstraintString(String constraintName, String[] foreignKey, String referencedTable,
            String[] primaryKey, boolean referencesPrimaryKey) {
        throw new UnsupportedOperationException(&quot;No add foreign key syntax supported by SQLiteDialect&quot;);
    }

    public String getAddPrimaryKeyConstraintString(String constraintName) {
        throw new UnsupportedOperationException(&quot;No add primary key syntax supported by SQLiteDialect&quot;);
    }

    public boolean supportsIfExistsBeforeTableName() {
        return true;
    }

    public boolean supportsCascadeDelete() {
        return false;
    }
}

</code></pre>

<h3 id="cllherreraprcontroller"><strong><code>cl.lherrera.pr.controller</code></strong></h3>
<p>Contiene el controlador del usuario o <code>UserController</code>, que maneja el proceso de los verbos de la siguiente URI: <code>/api/v1/users</code>.</p>
<p><strong><code>/produce-rest/src/main/java/cl/lherrera/pr/controller/UserController.java</code></strong></p>
<pre><code class="java">package cl.lherrera.pr.controller;

import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.HttpStatus;
import org.springframework.web.bind.annotation.DeleteMapping;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.PutMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.ResponseStatus;
import org.springframework.web.bind.annotation.RestController;

import cl.lherrera.pr.dto.UserDTO;
import cl.lherrera.pr.servicio.UserService;

@RestController
@RequestMapping(&quot;/api/v1/users&quot;)
public class UserController {
    @Autowired
    private UserService userService;

    @GetMapping(path = { &quot;&quot;, &quot;/&quot; })
    @ResponseStatus(code = HttpStatus.OK)
    public List&lt;UserDTO&gt; findAll() {
        return userService.encontrarTodos();
    }

    @GetMapping(path = &quot;/{id}&quot;)
    @ResponseStatus(code = HttpStatus.OK)
    public UserDTO findOne(@PathVariable Long id) {
        return userService.encontrarPorId(id);
    }

    @PostMapping(path = { &quot;&quot;, &quot;/&quot; })
    @ResponseStatus(HttpStatus.CREATED)
    public void create(@RequestBody UserDTO user) {
        userService.ingresar(user);
    }

    @PutMapping(path = { &quot;&quot;, &quot;/&quot; })
    @ResponseStatus(HttpStatus.OK)
    void update(@RequestBody UserDTO userDTO) {
        userService.actualizar(userDTO);
    }

    @DeleteMapping
    @ResponseStatus(HttpStatus.OK)
    void delete(@RequestBody UserDTO userDTO) {
        userService.eliminar(userDTO);
    }
}
</code></pre>

<h3 id="cllherreraprdto"><strong><code>cl.lherrera.pr.dto</code></strong></h3>
<p>Representación del objeto de negocio, es la presentación que posee el <code>JSON</code> de transporte, que, no siempre representa a una entidad en una tabla de la base de datos. En este caso, solamente contiene un DTO.</p>
<p><strong><code>/produce-rest/src/main/java/cl/lherrera/pr/dto/UserDTO.java</code></strong></p>
<pre><code class="java">package cl.lherrera.pr.dto;

public class UserDTO {
    private Long id;
    private String name;
    private String alias;

    public UserDTO() {
        // TODO Auto-generated constructor stub
    }

    public UserDTO(Long id, String name, String alias) {
        super();
        this.id = id;
        this.name = name;
        this.alias = alias;
    }

    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getAlias() {
        return alias;
    }

    public void setAlias(String alias) {
        this.alias = alias;
    }

    @Override
    public String toString() {
        return &quot;UserDTO [id=&quot; + id + &quot;, name=&quot; + name + &quot;, alias=&quot; + alias + &quot;]&quot;;
    }
}

</code></pre>

<h3 id="cllherreraprmodeloentity"><strong><code>cl.lherrera.pr.modelo.entity</code></strong></h3>
<p><strong><code>/produce-rest/src/main/java/cl/lherrera/pr/modelo/entity/User.java</code></strong></p>
<p>Contiene la representación en un objeto Java, tipo <code>User</code>, de la tabla <code>user</code> que debería estar en la base de datos.</p>
<pre><code class="java">package cl.lherrera.pr.modelo.entity;

import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;

@Entity
public class User {
    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private Long id;
    private String name;
    private String alias;

    public User() {
        // TODO Auto-generated constructor stub
    }

    public User(Long id, String name, String alias) {
        super();
        this.id = id;
        this.name = name;
        this.alias = alias;
    }

    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getAlias() {
        return alias;
    }

    public void setAlias(String alias) {
        this.alias = alias;
    }

    @Override
    public String toString() {
        return &quot;User [id=&quot; + id + &quot;, name=&quot; + name + &quot;, alias=&quot; + alias + &quot;]&quot;;
    }
}

</code></pre>

<h3 id="cllherreraprmodelorepository"><strong><code>cl.lherrera.pr.modelo.repository</code></strong></h3>
<p>Clase encargada de crear el DAO, es preparada e inyectada por <code>Spring</code>. En este caso como haremos las operaciones básicas <code>CRUD</code>, no es necesario indicar ningún método nuevo.</p>
<p><strong><code>/produce-rest/src/main/java/cl/lherrera/pr/modelo/repository/UserRepository.java</code></strong></p>
<pre><code class="java">package cl.lherrera.pr.modelo.repository;

import org.springframework.data.jpa.repository.JpaRepository;

import cl.lherrera.pr.modelo.entity.User;

public interface UserRepository extends JpaRepository&lt;User, Long&gt; {}

</code></pre>

<h3 id="cllherreraprservicio"><strong><code>cl.lherrera.pr.servicio</code></strong></h3>
<p>Contiene la lógica de negocio de la aplicación, esta la decidimos nosotros como desarrolladores, pensando en una hipotética situación a resolver. Si por ejemplo en esta clase, son implementados los métodos declarados en la interfaz, de todas las funcionalidades que debería tener el sistema cuando se solicitó su implementación.</p>
<p><strong><code>/produce-rest/src/main/java/cl/lherrera/pr/servicio/UserService.java</code></strong></p>
<pre><code class="java">package cl.lherrera.pr.servicio;

import java.util.List;

import cl.lherrera.pr.dto.UserDTO;

public interface UserService {

    void ingresar(UserDTO user); 
    void actualizar(UserDTO user); 
    List&lt;UserDTO&gt; encontrarTodos(); 
    UserDTO encontrarPorId(Long id); 
    void eliminar(UserDTO user);

}

</code></pre>

<p><strong><code>/produce-rest/src/main/java/cl/lherrera/pr/servicio/UserServiceImp.java</code></strong></p>
<pre><code class="java">package cl.lherrera.pr.servicio;

import java.util.List;
import java.util.stream.Collectors;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import cl.lherrera.pr.dto.UserDTO;
import cl.lherrera.pr.modelo.entity.User;
import cl.lherrera.pr.modelo.repository.UserRepository;
import cl.lherrera.pr.utils.DTOMapper;

@Service
public class UserServiceImp implements UserService {

    @Autowired
    UserRepository repoUsuario;

    @Override
    public void ingresar(UserDTO user) {
        repoUsuario.save(DTOMapper.toEntity(user));

    }

    @Override
    public void actualizar(UserDTO user) {
        repoUsuario.save(DTOMapper.toEntity(user));
    }

    @Override
    public List&lt;UserDTO&gt; encontrarTodos() {
        // cada elemento de la lista deberá ser
        // convertido en su dto.
        return repoUsuario.findAll().stream()
            .map(usuario -&gt; DTOMapper.toDTO(usuario))
            .collect(Collectors.toList());

    }

    @Override
    public UserDTO encontrarPorId(Long id) {
        User usuario = repoUsuario.findById(id).orElse(null);
        // TODO Auto-generated method stub
        return DTOMapper.toDTO(usuario);
    }

    @Override
    public void eliminar(UserDTO user) {
        User usuario = DTOMapper.toEntity(user);
        repoUsuario.delete(usuario);
    }
}

</code></pre>

<h3 id="cllherreraprutils"><strong><code>cl.lherrera.pr.utils</code></strong></h3>
<p>Contiene la clase que facilita la tarea de adaptar la información que está en las tablas con la que se debe presentar al usuario. La forma de la tabla es muy similar si no igual a la que está en la base de datos, o bien dicho a la que es representada por la entidad; pero esto no siempre es así, es por eso que el DTO es necesario.</p>
<p><strong><code>/produce-rest/src/main/java/cl/lherrera/pr/utils/DTOMapper.java</code></strong></p>
<pre><code class="java">package cl.lherrera.pr.utils;

import cl.lherrera.pr.dto.UserDTO;
import cl.lherrera.pr.modelo.entity.User;

public class DTOMapper {
    private DTOMapper() {
    }

    private static void toEntity(UserDTO userDTO, User user) {
        user.setId(userDTO.getId());
        user.setName(userDTO.getName());
        user.setAlias(userDTO.getAlias());
    }

    public static User toEntity(UserDTO userDTO) {
        User user = new User();
        toEntity(userDTO, user);
        return user;
    }

    public static UserDTO toDTO(User user) {
        UserDTO userDTO = new UserDTO();
        userDTO.setId(user.getId());
        userDTO.setName(user.getName());
        userDTO.setAlias(user.getAlias());
        return userDTO;
    }
}

</code></pre>

<h3 id="produce-restsrcmainresources"><strong><code>/produce-rest/src/main/resources</code></strong></h3>
<p>Propiedades del proyecto.</p>
<p><strong><code>/application.properties</code></strong></p>
<pre><code class="conf">spring.jpa.generate-ddl=true
spring.jpa.database-platform=cl.lherrera.pr.SQLiteDialect
spring.jpa.hibernate.ddl-auto=create-drop
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true

</code></pre>

<p><strong><code>/database.properties</code></strong></p>
<pre><code class="conf">driverClassName=org.sqlite.JDBC
url=jdbc:sqlite:produce-rest.db
username=jpaspring
password=sa
</code></pre>

<h3 id="produce-restpomxml"><strong><code>/produce-rest/pom.xml</code></strong></h3>
<p>Dependencias del proyecto</p>
<pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
    xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;parent&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
        &lt;version&gt;2.2.7.RELEASE&lt;/version&gt;
        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;
    &lt;/parent&gt;
    &lt;groupId&gt;cl.lherrera&lt;/groupId&gt;
    &lt;artifactId&gt;produce-rest&lt;/artifactId&gt;
    &lt;version&gt;20.0.0&lt;/version&gt;
    &lt;packaging&gt;war&lt;/packaging&gt;
    &lt;name&gt;produce-rest&lt;/name&gt;
    &lt;description&gt;api mod5 uni5 lectura 2&lt;/description&gt;

    &lt;properties&gt;
        &lt;java.version&gt;1.8&lt;/java.version&gt;
    &lt;/properties&gt;

    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;
            &lt;scope&gt;provided&lt;/scope&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
            &lt;scope&gt;test&lt;/scope&gt;
            &lt;exclusions&gt;
                &lt;exclusion&gt;
                    &lt;groupId&gt;org.junit.vintage&lt;/groupId&gt;
                    &lt;artifactId&gt;junit-vintage-engine&lt;/artifactId&gt;
                &lt;/exclusion&gt;
            &lt;/exclusions&gt;
        &lt;/dependency&gt;
        &lt;!-- SQLITE - SUPPORT --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.xerial&lt;/groupId&gt;
            &lt;artifactId&gt;sqlite-jdbc&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;!-- SQLITE - SUPPORT #--&gt;
    &lt;/dependencies&gt;

    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;

&lt;/project&gt;

</code></pre>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../../assets/javascripts/vendor.a0c4167b.min.js"></script>
      <script src="../../../../assets/javascripts/bundle.fb26dd1d.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../../../..",
          features: [],
          search: Object.assign({
            worker: "../../../../assets/javascripts/worker/search.37585f48.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>